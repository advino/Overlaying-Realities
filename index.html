<!DOCTYPE html>

<html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=.5">

<head>
  <title>WebApp Demo</title>

  <script src="webapp.js" type="text/javascript"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="ARjs/awe-v8.js" type="text/javascript"></script>
  <script src="ARjs/awe-loader.js" type="text/javascript"></script>
  <!-- <script src="ARjs/awe-standard.js" type="text/javascript"></script> -->
  <!-- <script src="ARjs/awe-standard-dependancies.js" type="text/javascript"></script> -->

  <style type="text/css">

    @font-face {
      font-family: Maison Neue;
      src: url(maisonneue-medium.ttf);
      font-weight: bold;
    }

    @font-face {
      font-family: Maison Neue;
      src: url(maisonneue-mono.ttf);
      font-weight: 100;
    }

    body {
      display: flex;
      justify-content: center;
      margin-top: 50px;
    }

    #container {
      display: block;
      padding: 20px;
      border-style: solid;
      border-width: medium;
      border-color: black;
      box-shadow: 5px 7px;
      width: 75%;
      height: auto;

    }

    video {
      display: none;
      margin: auto;
      margin-top: 15px;
      margin-bottom: 15px;
      width: 75%;


    }

    h3 {
      font-family: Maison Neue;
      font-weight: bold;
    }

    #blurb {
      display: block;
      font-family: Maison Neue;
      font-size: 14px;
      font-weight: 100;
      margin-bottom: 25px;
    }

    #fullScreen {
      display: block;
      margin: auto;
      padding: 10px;
      width: 75%;
      background: red;
      color: white;
      border: none;
      text-decoration: none;
      font-family: Maison Neue;
      font-weight: 100;
      font-size: 16px;

    }
  </style>

</head>

<body translate="no">


  <div id="container" style="margin: auto">
    <h3>Overlaying Realities</h3>
    <p id="blurb">
      This is the work-in-progress web app for Overlaying Realities.
      </br>
      </br>
      If you are using an iPhone, make sure you have iOS 11 installed.
      If you are on Android, this app should work fine on a variety of
      OS verions.

    </br>
    </br>
       I have created an immersive experience to help the residents
       of Providence understand how climate change will affect their
       lives on an individual level. Using both AR and Physical computing
       I will be mapping the effects of Urban Heating from future climates
       onto your daily routines and behaviors. Through this mapping, I hope
       to show you just how different your life will be under the hot sun
       of a future Providence.
    </p>
    <button id="fullScreen">Start App</button>
  </div>



<!-- Code for inserting media/AR -->
  <script>

    // Code for camera media


    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
    var video = document.createElement('video');
    video.style.width = document.width + 'px';
    video.style.height = document.height + 'px';
    video.setAttribute('autoplay', '');
    video.setAttribute('muted', '');
    video.setAttribute('playsinline', '');

    var facingMode = "environment";

    var constraints = {
      audio: false,
      video: {
        facingMode: facingMode
      }
    }

    navigator.mediaDevices.getUserMedia(constraints).then(function success(stream) {
      video.srcObject = stream;
    });



    var fullScreen = document.getElementById('fullScreen');
    var contain = document.getElementById('container');

    contain.insertBefore(video, fullScreen);

    fullScreen.addEventListener('click', function() {

      video.style.display = 'block';
      video.webkitEnterFullScreen();


      document.addEventListener("webkitfullscreenchange", function() {

        console.log(document.webkitIsFullScreen);
        if (document.webkitIsFullScreen == false) {
          video.style.display = 'none';
        }

      });
    });

    // AR based Code

    window.addEventListener('load', function() {
      window.awe.init({
        device_type: awe.AUTO_DETECT_DEVICE_TYPE,

        settings: {
          container_id: 'container',
          fps: 30,
          default_camera_position: {x:0,y:0,z:0},
          default_lights:[
            {
              id: 'hemisphere_light',
              type: 'hemisphere',
              color: 0xCCCCCC
            },
          ],
        },
        ready: function() {
          var d = '?_='+Date.now();

          awe.util.require([
            {
              capabilities: ['webgl', 'gum'],
              files: [
                ["ARjs/awe-standard-dependancies.js"+d, "Arjs/awe-standard.js"+d],
                ["ARjs/plugins/StereoEffect.js"+d, "ARjs/plugins/VREffect.js"+d],
                'ARjs/plugins/awe.rendering_effects.js'+d,
                'ARjs/plugins/awe.awe-standard-object_clicked_or_focused.js'+d,
                'awe.gryo.js'+d,
                'awe.mouse.js'+d,
              ],
              success: function() {
                awe.setup_scene();


              }
            }
          ])

        }
      });

      // Let console know if awe has initialized
      console.log('awe has been initialized');
    });




  </script>


</body>



</html>
